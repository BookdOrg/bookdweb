<!--
#########################################

    Business Page -- Consolidated View

########################################
-->
<div class="container-fluid">
    <div class="row">
        <div class="col-xs-12">
            <div class="text-center">
                <h1 class='text-center'>{{business.name}}</h1>

                <h3 class="text-center">
                    <uib-rating class="text-warning" ng-model="business.rating" max="max" readonly="isReadonly"
                                on-hover="hoveringOver(value)" on-leave="overStar = null"
                                titles="['one','two','three']">
                    </uib-rating>
                </h3>
                <div class="row">
                    <div class="col-xs-12">
                        <img ng-if="!business.photos" class="text-center" ng-src="{{business.icon}}"
                             uib-tooltip="Photos coming soon..."
                             tooltip-placement="right" style="border-radius:20%"></image>
                        <span ng-if="business.photos.length >1" ng-repeat="photo in business.photos">
                            <img ng-src="https://maps.googleapis.com/maps/api/place/photo?minwidth=200&maxwidth=200&minheight=133&maxheight=133&photoreference={{photo.photo_reference}}&key=AIzaSyAK1BOzJxHB8pOFmPFufYdcVdAuLr_6z2U">
                        </span>
                    </div>
                </div>
                <br>
            </div>
        </div>
    </div>
    <uib-tabset justified="true">
        <uib-tab>
            <uib-tab-heading>
                <i class="fa fa-calendar"></i> Services
            </uib-tab-heading>
            <div class="row services-associates-block">
                <!--
            #########################################

            Services Block

            ########################################
            -->
                <div class="text-center">
                    <h2 ng-if="business.info.services.length === 0">Services coming soon!</h2>
                </div>
            </div>
            <div class="row services-associates-block">
                <div class="col col-xs-6"
                     ng-repeat="service in business.info.services track by $index">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <i class="fa fa-calendar pull-left"></i>

                            <h2 class="panel-title">{{service.name}}
                            <span ng-show="editMode" class="pull-right">
                                <div class="btn-group">
                                    <a class="btn btn-sm btn-gradient-warning dropdown-toggle" href="#"
                                       data-toggle="dropdown"><i
                                            class="fa fa-cog"></i></a>
                                    <ul class="dropdown-menu">
                                        <li><a ng-click="openEditServiceModal(service, $index)" href="#"><i
                                                class="fa fa-pencil fa-fw text-warning"></i> Edit</a></li>
                                        <li><a href="#" ng-click="openRemoveServiceModal(service, $index)"><i
                                                class="fa fa-trash-o text-danger fa-fw"></i> Delete</a></li>
                                    </ul>
                                </div>
                            </span>
                            </h2>
                        </div>
                        <div class="panel-body service-panel-body">
                            <div class="row">
                                <div class="col-xs-6">
                                    <span class="text-muted">Description:</span>
                                    <small>{{service.description}}</small>
                                </div>
                                <div class="col-xs-6">
                                    <span class="text-muted">Associates:</span>
                                    <small ng-repeat="associate in service.employees">
                                        {{associate.name}},
                                    </small>

                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-6">
                                    <span class="text-muted">Duration:</span>
                                    <small>{{service.duration}} minutes</small>
                                </div>
                                <div class="col-xs-6">
                                    <span class="text-muted">Price:</span>
                                    <small>{{service.price | currency}}</small>
                                </div>
                            </div>
                        </div>
                        <div class="panel-footer service-panel-footer">
                            <button class="btn btn-gradient-blue btn-block"
                                    ng-click="scheduleAppointment('login', 'business', service);">
                                Book
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </uib-tab>
        <!--
 #########################################

     Employee Block

 ########################################
 -->
        <uib-tab>
            <uib-tab-heading>
                <i class="fa fa-users"></i> Staff
            </uib-tab-heading>
            <div class="row services-associates-block">
                <div class="col-xs-12 text-center">
                    <h2 class="text-center" ng-if="business.info.employees.length === 0">No Associates Listed
                        Yet!</h2>

                    <div class="row" ng-repeat="employee in business.info.employees" style="margin-bottom:20px;">
                        <div class="col col-xs-3">
                                <img class="associate-photo provider-photo-radius"
                                     ng-if="employee.provider === 'google_plus' && employee.photo"
                                     ng-src="{{employee.photo}}"/>
                                <img class="associate-photo provider-photo-radius"
                                     ng-if="employee.provider === 'google_plus' && !employee.photo"
                                     ng-src="{{cloudinaryDefaultPic}}"/>
                                <img class="associate-photo provider-photo-radius"
                                     ng-if="employee.provider === 'facebook'"
                                     ng-src="{{facebookApi}}{{employee.providerId}}/picture?type=large"/>

                                <img class="associate-photo"
                                     ng-if="!employee.avatarVersion && employee.provider === 'bookd'"
                                     ng-src="{{cloudinaryDefaultPic}}">
                                <img class="associate-photo"
                                     ng-if="employee.avatarVersion && employee.provider === 'bookd'"
                                     ng-src="{{cloudinaryBaseUrl}}{{employee.avatarVersion}}/profile/{{employee._id}}">
                        </div>
                        <div class="col col-xs-8 text-center">
                            <h4>{{employee.name}}</h4>
                            <uib-rating class="text-warning" ng-model="rate" max="max" readonly="isReadonly"
                                        on-hover="hoveringOver(value)" on-leave="overStar = null"
                                        titles="['one','two','three']">
                            </uib-rating>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam sit amet sapien odio.
                                Fusce massa risus, pulvinar quis dui id, commodo laoreet felis.</p>
                            <a href="/user/{{employee._id}}/profile">View Profile</a>
                        </div>
                    </div>
                    <div class="row" ng-if="!business.info.employees">
                        <div class="col-xs-12">
                            <h1 class="text-center">Your business does not have any employee's registered yet.</h1>
                        </div>
                    </div>
                </div>
            </div>
        </uib-tab>
        <!--
    #########################################

     Info Block

    ########################################
    -->
        <uib-tab>
            <uib-tab-heading>
                <i class="fa fa-info"></i> Info
            </uib-tab-heading>
            <div class="row services-associates-block">
                <div class="col-xs-7" style="margin-top:5px;">
                    <iframe
                            width="100%"
                            height="50%"
                            frameborder="0" style="border:0"
                            ng-src="{{ business.place_id | staticMapsFilter }}" allowfullscreen>
                    </iframe>
                </div>
                <div class="col-xs-4 text-center panel panel-default">
                    <div class="panel-body">
                        <p>
                            <a ng-href="{{business.url}}" target="_blank"><i class="fa fa-google-plus"></i> Google</a>
                        </p>

                        <p>
                            <a ng-href="{{business.website}}" target="_blank"> <i class="fa fa-globe"></i>
                                {{business.website}}</a>
                        </p>

                        <p>{{business.formatted_address}}</p>

                        <p><i class="fa fa-phone"></i> {{business.formatted_phone_number}}</p>

                        <ul class="hours-list" ng-if="business.opening_hours"
                            ng-repeat="hours in business.opening_hours.weekday_text">
                            <li>{{hours}}</li>
                        </ul>
                            <span ng-if="!business.opening_hours">
                                    No information about {{business.name}}'s hours of operation is available.
                            </span>
                    </div>
                </div>
            </div>
        </uib-tab>
        <!--
     #########################################

         Reviews Block

     ########################################
     -->
        <uib-tab>
            <uib-tab-heading>
                <i class="fa fa-commenting"></i> Reviews
            </uib-tab-heading>
            <div class="row">
                <div class="col-xs-12">
                    <h2 class="text-center" ng-if="!business.reviews">No Reviews Yet!</h2>
                </div>
            </div>
            <div class="row" style="margin-top:20px;">
                <div class="col-xs-4 reviewBox" ng-repeat="review in business.reviews track by $index">
                    <img ng-src="{{review.user.image_url}}" style="border-radius:20%">
                    <br>User: <span><a href="{{review.author_url}}">{{review.author_name}}</a></span>
                    <br>
                    Rating: {{review.rating}}
                    <br>
                    {{review.text}}
                    <hr>
                </div>
            </div>
            <div class="row text-center">
                <div class="col-xs-12">
                    <img src="/images/powered_by_google_on_white_hdpi.png">
                </div>
            </div>
        </uib-tab>
    </uib-tabset>
</div>