<!--
#########################################

    Business Page -- Consolidated View

########################################
-->
<div class="container-fluid">
    <div class="row">
        <div class="col-xs-12">
            <div class="text-center">
                <h1 class='text-center'>{{business.name}}</h1>

                <h3 class="text-center">
                    <uib-rating class="text-warning" ng-model="business.rating" max="max" readonly="isReadonly"
                                on-hover="hoveringOver(value)" on-leave="overStar = null"
                                titles="['one','two','three']">
                    </uib-rating>
                </h3>
                <div class="row">
                    <div class="col-xs-12">
                        <img ng-if="!business.photos" class="text-center" ng-src="{{business.icon}}"
                             uib-tooltip="Photos coming soon..."
                             tooltip-placement="right" style="border-radius:20%"></image>
                        <span ng-if="business.photos.length >1" ng-repeat="photo in business.photos">
                            <img ng-src="https://maps.googleapis.com/maps/api/place/photo?minwidth=200&maxwidth=200&minheight=133&maxheight=133&photoreference={{photo.photo_reference}}&key=AIzaSyAK1BOzJxHB8pOFmPFufYdcVdAuLr_6z2U">
                        </span>
                    </div>
                </div>
                <br>
            </div>
        </div>
    </div>
    <uib-tabset justified="true">
        <uib-tab>
            <uib-tab-heading>
                <i class="fa fa-calendar"></i> Services & Staff
            </uib-tab-heading>
            <div class="row services-associates-block">
                <!--
            #########################################

            Services Block

            ########################################
            -->
                <div class="col-xs-7 text-center">
                    <h2 ng-if="business.info.services.length === 0">Services coming soon!</h2>
                    <div class="row">
                        <div class="col col-xs-12 col-sm-12 col-md-6 co-lg-6"
                             ng-repeat="service in business.info.services track by $index">
                            <div class="panel panel-primary">
                                <div class="panel-heading">
                                    <i class="fa fa-calendar pull-left"></i>
                                    <h2 class="panel-title">{{service.name}}
                                    <span ng-show="editMode" class="pull-right">
                                        <div class="btn-group">
                                            <a class="btn btn-sm btn-warning dropdown-toggle" href="#"
                                               data-toggle="dropdown"><i
                                                    class="fa fa-cog"></i></a>
                                            <ul class="dropdown-menu">
                                                <li><a ng-click="openEditServiceModal(service, $index)" href="#"><i
                                                        class="fa fa-pencil fa-fw text-warning"></i> Edit</a></li>
                                                <li><a href="#" ng-click="openRemoveServiceModal(service, $index)"><i
                                                        class="fa fa-trash-o text-danger fa-fw"></i> Delete</a></li>
                                            </ul>
                                        </div>
                                    </span>
                                    </h2>
                                </div>
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-xs-6">
                                            <span class="text-muted">Description:</span>
                                            <small>{{service.description}}</small>
                                        </div>
                                        <div class="col-xs-6">
                                            <span class="text-muted">Associates:</span>
                                            <small ng-repeat="associate in service.employees">
                                                {{associate.name}},
                                            </small>

                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-6">
                                            <span class="text-muted">Duration:</span>
                                            <small>{{service.duration}} minutes</small>
                                        </div>
                                        <div class="col-xs-6">
                                            <span class="text-muted">Price:</span>
                                            <small>{{service.price | currency}}</small>
                                        </div>
                                    </div>



                                </div>
                                <div class="panel-footer service-panel-footer">
                                    <button class="btn btn-primary btn-block"
                                            ng-click="scheduleAppointment('login', 'business', service);">
                                        Book
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--
                 #########################################

                     Employee Block

                 ########################################
                 -->
                <div class="col-xs-4 text-center associate-margin-left">
                    <h2 class="text-center" ng-if="business.info.employees.length === 0">No Associates Listed
                        Yet!</h2>
                    <div class="row">
                        <div class="col col-xs-12 col-sm-6 col-lg-4 text-center"
                             ng-repeat="employee in business.info.employees">
                            <a href="/user/{{employee._id}}/profile"
                               uib-tooltip="Visit {{employee.name}}'s Profile"
                               tooltip-placement="bottom">
                                <img class="associate-photo provider-photo-radius"
                                     ng-if="employee.provider === 'google_plus' && employee.photo"
                                     ng-src="{{employee.photo}}"/>
                                <img class="associate-photo provider-photo-radius"
                                     ng-if="employee.provider === 'google_plus' && !employee.photo"
                                     ng-src="{{cloudinaryDefaultPic}}"/>
                                <img class="associate-photo provider-photo-radius"
                                     ng-if="employee.provider === 'facebook'"
                                     ng-src="{{facebookApi}}{{employee.providerId}}/picture?type=large"/>

                                <img class="associate-photo"
                                     ng-if="!employee.avatarVersion && employee.provider === 'bookd'"
                                     ng-src="{{cloudinaryDefaultPic}}">
                                <img class="associate-photo"
                                     ng-if="employee.avatarVersion && employee.provider === 'bookd'"
                                     ng-src="{{cloudinaryBaseUrl}}{{employee.avatarVersion}}/profile/{{employee._id}}">

                                <div class="">
                                    <h4>{{employee.name}}</h4>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="row" ng-if="!business.info.employees">
                        <div class="col-xs-12">
                            <h1 class="text-center">Your business does not have any employee's registered yet.</h1>
                        </div>
                    </div>
                </div>
            </div>
        </uib-tab>
        <!--
    #########################################

     Info Block

    ########################################
    -->
        <uib-tab select="reRenderMap()">
            <uib-tab-heading>
                <i class="fa fa-info"></i> Info
            </uib-tab-heading>
            <div class="row">
                <div class="col-xs-7" style="margin-top:5px;">
                    <ng-map class="map-container" zoom="14" center="{{businessCenter}}">
                        <!--<marker position="{{businessCenter}}" icon="/images/currLocationIcon.png"></marker>-->
                        <marker position="{{businessCenter}}"></marker>
                    </ng-map>
                </div>
                <div class="col-xs-5 text-center">
                    <p>
                        <a href="{{business.url}}" target="_blank"><i class="fa fa-google-plus"></i> Google</a>
                    </p>

                    <p>
                        <a href="{{business.website}}" target="_blank"> <i class="fa fa-globe"></i>
                            {{business.website}}</a>
                    </p>

                    <p>Location: {{business.formatted_address}}</p>

                    <p><i class="fa fa-phone"></i> {{business.formatted_phone_number}}</p>

                    <p>Hours:</p>
                    <ul class="hours-list" ng-if="business.opening_hours"
                        ng-repeat="hours in business.opening_hours.weekday_text">
                        <li>{{hours}}</li>
                    </ul>
                        <span ng-if="!business.opening_hours">
                                No information about {{business.name}}'s hours of operation is available.
                        </span>
                </div>
            </div>
        </uib-tab>
        <!--
     #########################################

         Reviews Block

     ########################################
     -->
        <uib-tab>
            <uib-tab-heading>
                <i class="fa fa-commenting"></i> Reviews
            </uib-tab-heading>
            <div class="row">
                <div class="col-xs-12">
                    <h1 class="text-center">Reviews</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12">
                    <h2 class="text-center" ng-if="!business.reviews">No Reviews Yet!</h2>
                </div>
            </div>
            <div class="row">
                <div class="well col-xs-4 reviewBox" ng-repeat="review in business.reviews track by $index">
                    <img ng-src="{{review.user.image_url}}" style="border-radius:20%">
                    <br>User: <span><a href="{{review.author_url}}">{{review.author_name}}</a></span>
                    <br>
                    Rating: {{review.rating}}
                    <br>
                    {{review.text}}
                </div>
            </div>
            <div class="row text-center">
                <div class="col-xs-12">
                    <img src="/images/powered_by_google_on_white_hdpi.png">
                </div>
            </div>
        </uib-tab>
    </uib-tabset>
</div>