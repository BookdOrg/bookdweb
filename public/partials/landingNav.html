<!-- Custom CSS -->
<link href="/stylesheets/nav/agency.css" rel="stylesheet">
<link href="/stylesheets/nav/landingNav.css" rel="stylesheet">
<nav class="navbar navbar-default navbar-fixed-top" ng-controller="NavCtrl">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" ui-sref="landing"><i class="fa fa-calendar"></i>Bookd</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse nav-container" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a ui-sref="partner" ng-if="forBusiness">List Your Business</a>
                    <a ui-sref="landing" ng-if="!forBusiness">Back To Booking</a>
                </li>
                <li uib-dropdown ng-show="isLoggedIn()" class="hidden-xs">
                    <!--https://stackoverflow.com/questions/15316363/how-to-display-length-of-filtered-ng-repeat-data-->
                    <a href="#" uib-dropdown-toggle>
                        <i class="fa fa-bell badge {{currentUser.user.notifications | newNotificationFilter}}">
                            {{currentUser.user.notifications | notificationFilter}}
                        </i>
                    </a>

                    <div class="uib-dropdown-menu notifications" ng-click="$event.stopPropagation()" role="menu"
                         aria-labelledby="dLabel">
                        <div class="notification-heading" ng-if="currentUser.user.notifications.length > 0">
                            <h4 class="menu-title">Notifications</h4>
                            <h4 class="menu-title pull-right" ng-click="viewAllNotifications()">Mark all as
                                viewed</h4>
                        </div>
                        <span class="divider"></span>

                        <h3 class="text-center" ng-if="currentUser.user.notifications.length === 0">You have no
                            notifications!</h3>
                        <ul class="notifications-wrapper">
                            <li class="content" ng-repeat="notification in currentUser.user.notifications">
                                <div class="notification-item"
                                     ng-class="{'new-notification': notification.viewed === false}">
                                    <h5 class="pull-right" ng-click="viewNotification($index)"
                                        ng-if="notification.viewed === false"><i class="fa fa-times-circle-o"
                                                                                 uib-tooltip="Mark Read"
                                                                                 tooltip-placement="top"
                                                                                 tooltip-append-to-body="true"></i>
                                    </h5>
                                    <h5>{{notification.content}}</h5>

                                    <div class="row">
                                        <div class="col-xs-6">
                                            <h5 class="notification-timestamp"><i>{{notification.timestamp |
                                                timeStampFilter}}</i>
                                            </h5>
                                        </div>
                                        <div class="col-xs-6">
                                            <a id="calendarLink" ng-if="notification.type === 'calendar'"
                                               class="pull-right notification-link" ui-sref="calendar">Go to
                                                calendar
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
                <li uib-dropdown ng-show="isLoggedIn()" class="hidden-xs">
                    <a href="" uib-dropdown-toggle class=" avatarPadding">
                        <img class="navbarAvatar"
                             ng-if="!currentUser.user.avatarVersion && currentUser.user.provider === 'bookd'"
                             ng-src="{{cloudinaryDefaultPic}}"/>
                        <img class="navbarAvatar"
                             ng-if="currentUser.user.avatarVersion && currentUser.user.provider === 'bookd'"
                             ng-src="{{cloudinaryBaseUrl}}{{currentUser.user.avatarVersion}}/profile/{{currentUser.user._id}}"/>
                        <img class="navbarAvatar" ng-if="currentUser.user.provider === 'google_plus'"
                             ng-src="{{currentUser.providerInfo}}"/>
                        <img class="navbarAvatar" ng-if="currentUser.user.provider === 'facebook'"
                             ng-src="{{currentUser.providerInfo}}"/>
                        {{currentUser.user.name}} <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="uib-dropdown-menu droplinks">
                        <li ng-hide="!isLoggedIn()">
                            <a ui-sref="search">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                        <li>
                            <a ui-sref="calendar" ng-click="showSearch(false)">
                                <i class="fa fa-thumb-tack"></i> Appointments
                            </a>
                        </li>
                        <li>
                            <a ng-if="currentUser.user.businessOwner" ng-click="showSearch(false)"
                               ui-sref="dashboard">
                                <i class="fa fa-tachometer"></i> Manage
                            </a>
                        </li>
                        <li>
                            <a ui-sref="account({id:currentUser.user._id})" ng-click="showSearch(false)">
                                <i class="fa fa-cog"></i> Settings
                            </a>
                        </li>
                        <hr>
                        <li>
                            <a ng-click="logOut()">
                                <i class="fa fa-sign-out"></i> Log Out
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="hidden-sm hidden-md hidden-lg">
                    <a ui-sref="search" ui-sref-active="active"
                       ng-click="navbarCollapsed = !navbarCollapsed;">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li ng-if="isLoggedIn()" class="hidden-sm hidden-md hidden-lg">
                    <a ui-sref="calendar" ng-click="">
                        <i class="fa fa-thumb-tack"></i> Appointments
                    </a>
                </li>
                <li ng-if="isLoggedIn() && currentUser.user.isAssociate" class="hidden-sm hidden-md hidden-lg">
                    <a ng-click="navbarCollapsed = !navbarCollapsed;"
                       ui-sref="user({id:currentUser.user._id})">
                        <i class="fa fa-user"></i> Profile
                    </a>
                </li>
                <li ng-if="currentUser.user.businessOwner" class="hidden-sm hidden-md hidden-lg">
                    <a ng-click="navbarCollapsed = !navbarCollapsed;" ui-sref="dashboard">
                        <i class="fa fa-tachometer"></i> Manage
                    </a>
                </li>
                <li ng-if="isLoggedIn()" class="hidden-sm hidden-md hidden-lg">
                    <a ui-sref="account({id:currentUser.user._id})" ng-click="">
                        <i class="fa fa-cog"></i> Settings
                    </a>
                </li>
                <hr>
                <li ng-if="!isLoggedIn()">
                    <a ng-click="checkStateandLogin('login')"><i class="fa fa-sign-in"></i>Log In</a>
                </li>
                <li ng-if="!isLoggedIn()">
                    <a ng-click="checkStateandLogin('signup')"><i class="fa fa-user"></i>Sign Up</a>
                </li>
                <li ng-if="isLoggedIn()" class="hidden-sm hidden-md hidden-lg">
                    <a ng-click="logOut()">
                        <i class="fa fa-sign-out"></i> Log Out
                    </a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
<script src="/javascripts/vendor/classie.js"></script>
<script src="/javascripts/vendor/cbpAnimatedHeader.js"></script>

<script src="/javascripts/vendor/agency.js"></script>